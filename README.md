# ğŸ¥ AI Doctor - æ™ºèƒ½åŒ»ç–—æ•°å­—äººå¹³å°

> åŸºäºå¤šæ¨¡æ€AIçš„æ™ºèƒ½åŒ»ç–—åŠ©æ‰‹ç³»ç»Ÿï¼Œä¸“æ³¨äºä¸­åŒ»å¤„æ–¹å½•å…¥ã€ç—…å†ç®¡ç†å’ŒåŒ»æ‚£äº¤äº’

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Platform](https://img.shields.io/badge/Platform-macOS%20%7C%20Linux-lightgrey.svg)]()

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ä½¿ç”¨æ–‡æ¡£](#ä½¿ç”¨æ–‡æ¡£)
- [APIæ¥å£](#apiæ¥å£)
- [é…ç½®æŒ‡å—](#é…ç½®æŒ‡å—)
- [å¼€å‘è·¯çº¿](#å¼€å‘è·¯çº¿)

---

## é¡¹ç›®ç®€ä»‹

AI Doctor æ˜¯ä¸€ä¸ªé›†æˆäº†**è¯­éŸ³è¯†åˆ«**ã€**è‡ªç„¶è¯­è¨€å¤„ç†**ã€**çŸ¥è¯†å›¾è°±**å’Œ**æ•°å­—äººäº¤äº’**çš„æ™ºèƒ½åŒ»ç–—å¹³å°ã€‚ç³»ç»Ÿç‰¹åˆ«é’ˆå¯¹**ä¸­åŒ»å¤„æ–¹å½•å…¥**åœºæ™¯è¿›è¡Œäº†æ·±åº¦ä¼˜åŒ–ï¼Œæ”¯æŒå®æ—¶è¯­éŸ³è½¬æ–‡å­—ã€æ™ºèƒ½è¯æè¯†åˆ«ã€å‰‚é‡æ ‡å‡†åŒ–ç­‰åŠŸèƒ½ã€‚

### ğŸ¯ åº”ç”¨åœºæ™¯

- **ä¸­åŒ»è¯Šæ‰€**ï¼šè¯­éŸ³å½•å…¥å¤„æ–¹ï¼Œè‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–å¤„æ–¹å•
- **åŒ»æ‚£å’¨è¯¢**ï¼šæ™ºèƒ½é—®ç­”ï¼Œæä¾›åŒ»å­¦çŸ¥è¯†è§£ç­”
- **æŠ¥å‘Šè§£è¯»**ï¼šä¸Šä¼ æ£€æŸ¥æŠ¥å‘Šï¼ŒAIè‡ªåŠ¨è§£è¯»åˆ†æ
- **ç—…å†ç®¡ç†**ï¼šè‡ªåŠ¨ç”Ÿæˆç”µå­ç—…å†ï¼Œç®¡ç†æ‚£è€…æ¡£æ¡ˆ
- **è¿œç¨‹åŒ»ç–—**ï¼šæ•°å­—äººè§†é¢‘äº¤äº’ï¼Œæä¾›è¿œç¨‹å’¨è¯¢æœåŠ¡

### âœ¨ æ ¸å¿ƒä¼˜åŠ¿

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| ğŸ™ï¸ **ä¸“ä¸šASR** | é’ˆå¯¹ä¸­åŒ»åœºæ™¯ä¼˜åŒ–ï¼Œ11,000+ä¸­è‰è¯çƒ­è¯åº“ |
| ğŸ§  **æ™ºèƒ½çº é”™** | åŸºäºæ‹¼éŸ³ç›¸ä¼¼åº¦çš„è¯æåç§°è‡ªåŠ¨çº é”™ |
| ğŸ“Š **ç»“æ„åŒ–è¾“å‡º** | è‡ªåŠ¨æå–è¯æã€å‰‚é‡ã€å•ä½ï¼Œç”Ÿæˆæ ‡å‡†å¤„æ–¹ |
| ğŸ’¬ **å¤šæ¨¡æ€äº¤äº’** | æ”¯æŒæ–‡æœ¬ã€è¯­éŸ³ã€å›¾ç‰‡ã€è§†é¢‘è¾“å…¥ |
| ğŸ¤– **æ•°å­—äºº** | Wav2Lipå”‡å½¢åŒæ­¥ï¼ŒçœŸå®æ„Ÿå¼º |
| ğŸ” **çŸ¥è¯†å¢å¼º** | RAGæ£€ç´¢ + çŸ¥è¯†å›¾è°±ï¼Œå›ç­”æ›´å‡†ç¡® |

---

## æ ¸å¿ƒåŠŸèƒ½

### 1ï¸âƒ£ å®æ—¶è¯­éŸ³è¯†åˆ«ï¼ˆASRï¼‰

#### ç‰¹è‰²åŠŸèƒ½

```python
# è¾“å…¥ï¼šè¯­éŸ³ "ä¸‰ä¸ƒåäº”å…‹ï¼Œé»„èŠªäºŒåå…‹ï¼Œå…šå‚åäº”å…‹"
# è¾“å‡ºï¼šä¸‰ä¸ƒ15gï¼Œé»„èŠª20gï¼Œå…šå‚15g
```

**æŠ€æœ¯äº®ç‚¹**ï¼š
- âœ… ä¸­æ–‡æ•°å­—æ™ºèƒ½è½¬æ¢ï¼ˆåäº” â†’ 15ï¼‰
- âœ… è¯æåç§°æ‹¼éŸ³çº é”™ï¼ˆæ–­ä¿¡çŸ³ â†’ é”»ä¿¡çŸ³ï¼‰
- âœ… å•ä½è‡ªåŠ¨æ ‡å‡†åŒ–ï¼ˆå…‹ â†’ gï¼Œæ¯«å…‹ â†’ mgï¼‰
- âœ… ç‰¹æ®Šè¯æä¼˜å…ˆåŒ¹é…ï¼ˆä¸‰ä¸ƒã€äº”å‘³å­ç­‰ï¼‰
- âœ… å®æ—¶æµå¼è¯†åˆ«ï¼Œä½å»¶è¿Ÿ

#### æ”¯æŒçš„ASRå¼•æ“

- **é˜¿é‡Œäº‘ FunASR**ï¼šç¦»çº¿è¯†åˆ«ï¼Œéšç§ä¿æŠ¤
- **é˜¿é‡Œäº‘å®æ—¶ASR**ï¼šäº‘ç«¯è¯†åˆ«ï¼Œå‡†ç¡®ç‡é«˜
- **è‡ªå®šä¹‰çƒ­è¯**ï¼šåŠ¨æ€åŠ è½½é¢†åŸŸè¯åº“

### 2ï¸âƒ£ æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ

- **ä¼šè¯ç®¡ç†**ï¼šæ”¯æŒå¤šä¼šè¯å¹¶å‘ï¼Œè‡ªåŠ¨ä¿å­˜å†å²
- **ä¸Šä¸‹æ–‡ç†è§£**ï¼šè®°å¿†æ‚£è€…ä¿¡æ¯ï¼Œè¿ç»­å¯¹è¯
- **å¤šè½®äº¤äº’**ï¼šæ”¯æŒè¿½é—®ã€æ¾„æ¸…ã€ç¡®è®¤
- **æƒ…æ„Ÿè¯†åˆ«**ï¼šç†è§£æ‚£è€…æƒ…ç»ªï¼Œç»™äºˆé€‚å½“å›åº”

### 3ï¸âƒ£ åŒ»å­¦æŠ¥å‘Šè§£è¯»

```
æ”¯æŒæ ¼å¼ï¼šJPG, PNG, PDF
è¯†åˆ«å†…å®¹ï¼šè¡€å¸¸è§„ã€å°¿å¸¸è§„ã€CTã€MRIã€Xå…‰ç‰‡ç­‰
è¾“å‡ºå†…å®¹ï¼šæŒ‡æ ‡è§£è¯»ã€å¼‚å¸¸æç¤ºã€å¥åº·å»ºè®®
```

**æŠ€æœ¯æ–¹æ¡ˆ**ï¼š
- OCRæ–‡å­—æå–ï¼ˆPaddleOCRï¼‰
- å¤šæ¨¡æ€å¤§æ¨¡å‹ç†è§£ï¼ˆGPT-4V / Qwen-VLï¼‰
- åŒ»å­¦çŸ¥è¯†åº“åŒ¹é…

### 4ï¸âƒ£ ç”µå­ç—…å†ç”Ÿæˆ

è‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–ç—…å†ï¼ŒåŒ…å«ï¼š
- ä¸»è¯‰ã€ç°ç—…å²ã€æ—¢å¾€å²
- ä½“æ ¼æ£€æŸ¥ã€è¾…åŠ©æ£€æŸ¥
- è¯Šæ–­ã€å¤„æ–¹ã€åŒ»å˜±

### 5ï¸âƒ£ æ•°å­—äººäº¤äº’

- **TTSè¯­éŸ³åˆæˆ**ï¼šå¤šç§éŸ³è‰²å¯é€‰
- **Wav2Lipå”‡å½¢åŒæ­¥**ï¼šå£å‹ä¸è¯­éŸ³ç²¾å‡†åŒ¹é…
- **å®æ—¶è§†é¢‘æµ**ï¼šWebRTCä½å»¶è¿Ÿä¼ è¾“
- **å½¢è±¡ç®¡ç†**ï¼šå¯é…ç½®ä¸åŒæ•°å­—äººå½¢è±¡

---

## æŠ€æœ¯æ¶æ„

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯å±‚ (React)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è¯­éŸ³è¾“å…¥ â”‚  â”‚ æ–‡æœ¬è¾“å…¥ â”‚  â”‚ å›¾ç‰‡ä¸Šä¼  â”‚  â”‚ è§†é¢‘æµ  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   WebSocketæœåŠ¡å±‚                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ä¼šè¯ç®¡ç† â”‚ æ¶ˆæ¯è·¯ç”± â”‚ çŠ¶æ€åŒæ­¥ â”‚ è¿æ¥æ± ç®¡ç†    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸šåŠ¡é€»è¾‘å±‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ASRæ¨¡å—  â”‚  â”‚ NLPæ¨¡å—  â”‚  â”‚ TTSæ¨¡å—  â”‚  â”‚ æ•°å­—äºº  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ RAGæ£€ç´¢  â”‚  â”‚ çŸ¥è¯†å›¾è°± â”‚  â”‚ ç—…å†ç®¡ç† â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AIæ¨¡å‹å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  FunASR  â”‚  â”‚ GPT-4/5  â”‚  â”‚  Qwen    â”‚  â”‚ Wav2Lip â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—

```
ai_doctor/
â”œâ”€â”€ ğŸ™ï¸ asr/                    # è¯­éŸ³è¯†åˆ«
â”‚   â”œâ”€â”€ AliRealtime_ASR.py     # é˜¿é‡Œäº‘å®æ—¶ASR
â”‚   â”œâ”€â”€ FunASR.py              # FunASRç¦»çº¿
â”‚   â”œâ”€â”€ RealtimeFunASR.py      # FunASRå®æ—¶
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ asr_postprocessor.py  # ä¸­åŒ»å¤„æ–¹åå¤„ç† â­
â”‚
â”œâ”€â”€ ğŸ’¬ chat_manager/           # å¯¹è¯ç®¡ç†
â”‚   â”œâ”€â”€ chat_instance.py       # ä¼šè¯å®ä¾‹
â”‚   â”œâ”€â”€ asr_task.py            # ASRä»»åŠ¡
â”‚   â”œâ”€â”€ nlp_task.py            # NLPä»»åŠ¡
â”‚   â””â”€â”€ tts_task.py            # TTSä»»åŠ¡
â”‚
â”œâ”€â”€ ğŸ¤– llm/                    # å¤§æ¨¡å‹é›†æˆ
â”‚   â”œâ”€â”€ ChatGPT.py             # OpenAI
â”‚   â”œâ”€â”€ Qwen.py                # é€šä¹‰åƒé—®
â”‚   â”œâ”€â”€ Gemini.py              # Google
â”‚   â””â”€â”€ VllmGPT.py             # vLLMæ¨ç†
â”‚
â”œâ”€â”€ ğŸ” rag/                    # æ£€ç´¢å¢å¼º
â”‚   â”œâ”€â”€ rag_chain.py           # RAGé“¾è·¯
â”‚   â””â”€â”€ retrieve/              # æ£€ç´¢å™¨
â”‚
â”œâ”€â”€ ğŸ§  kg/                     # çŸ¥è¯†å›¾è°±
â”‚   â””â”€â”€ Graph.py               # Neo4j
â”‚
â”œâ”€â”€ ğŸ¬ model/                  # AIæ¨¡å‹
â”‚   â”œâ”€â”€ RAG/                   # å‘é‡æ¨¡å‹
â”‚   â”œâ”€â”€ KG/                    # å›¾è°±æ¨¡å‹
â”‚   â””â”€â”€ wav2lip/               # å”‡å½¢åŒæ­¥
â”‚
â”œâ”€â”€ ğŸŒ webdemo_medical/        # Webå‰ç«¯
â”‚   â””â”€â”€ react/                 # Reactåº”ç”¨
â”‚
â””â”€â”€ ğŸ“Š data/                   # æ•°æ®èµ„æº
    â”œâ”€â”€ åŒ»ä¿ä¸­è‰è¯æ•°æ®_å…±11071æ¡.csv
    â”œâ”€â”€ å´å«å¹³å¤„æ–¹æ•°æ®.xlsx
    â””â”€â”€ medical_books/         # åŒ»å­¦ä¹¦ç±
```

---

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

**ç³»ç»Ÿè¦æ±‚**ï¼š
- macOS 10.15+ / Ubuntu 18.04+
- Python 3.8+
- Node.js 16+ (å‰ç«¯å¼€å‘)
- 8GB+ RAM

**å¯é€‰ç»„ä»¶**ï¼š
- Neo4j 4.0+ (çŸ¥è¯†å›¾è°±)
- CUDA 11.0+ (GPUåŠ é€Ÿ)

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-repo/ai_doctor.git
cd ai_doctor
```

#### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
python -m venv venv
source venv/bin/activate  # macOS/Linux
# venv\Scripts\activate   # Windows
```

#### 3. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

#### 4. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶å¹¶ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env`ï¼š

```bash
# é˜¿é‡Œäº‘ASR
ALIYUN_ASR_TOKEN=your_token_here
ALIYUN_ASR_APPKEY=your_appkey_here

# LLM API
DASHSCOPE_API_KEY=sk-xxx  # é€šä¹‰åƒé—®
DEEPSEEK_API_KEY=sk-xxx   # DeepSeek
OPENIAI_API_KEY=sk-xxx    # OpenAI

# æœåŠ¡é…ç½®
ASR_SERVER_HOST=0.0.0.0
ASR_SERVER_PORT=50007
WS_PORT=8081
HTTP_PORT=8080
```

#### 5. å¯åŠ¨æœåŠ¡

**æ–¹å¼ä¸€ï¼šå¯åŠ¨å®Œæ•´æœåŠ¡ï¼ˆæ¨èï¼‰**

```bash
python webdemo_medical_server.py
```

è®¿é—®ï¼š`http://localhost:8080`

**æ–¹å¼äºŒï¼šå¯åŠ¨ç‹¬ç«‹ASRæœåŠ¡**

```bash
python server.py
```

WebSocketåœ°å€ï¼š`ws://localhost:50007`

**æ–¹å¼ä¸‰ï¼šå¯åŠ¨Gradioæ¼”ç¤º**

```bash
python app.py
```

---

## ä½¿ç”¨æ–‡æ¡£

### è¯­éŸ³å¤„æ–¹å½•å…¥ç¤ºä¾‹

#### Pythonè°ƒç”¨

```python
from asr.RealtimeFunASR import RealtimeFunASR
from asr.utils.asr_postprocessor import postprocess_asr

# åˆå§‹åŒ–ASR
asr = RealtimeFunASR()

# è¯†åˆ«éŸ³é¢‘
raw_text = asr.recognize("audio.wav")
print(f"åŸå§‹è¯†åˆ«: {raw_text}")
# è¾“å‡º: "ä¸‰ä¸ƒåäº”å…‹é»„èŠªäºŒåå…‹å…šå‚åäº”å…‹"

# åå¤„ç†
processed = postprocess_asr(raw_text)
print(f"å¤„ç†ç»“æœ: {processed}")
# è¾“å‡º: "ä¸‰ä¸ƒ15gï¼Œé»„èŠª20gï¼Œå…šå‚15g"
```

#### å¤„ç†æµç¨‹

```
åŸå§‹è¯­éŸ³
    â†“
[ASRè¯†åˆ«] â†’ "ä¸‰ä¸ƒåäº”å…‹é»„èŠªäºŒåå…‹"
    â†“
[æ ‡ç‚¹åˆ‡åˆ†] â†’ ["ä¸‰ä¸ƒåäº”å…‹", "é»„èŠªäºŒåå…‹"]
    â†“
[ä¸­æ–‡æ•°å­—è½¬æ¢] â†’ ["ä¸‰ä¸ƒ15å…‹", "é»„èŠª20å…‹"]
    â†“
[è¯æåç§°çº é”™] â†’ ["ä¸‰ä¸ƒ15å…‹", "é»„èŠª20å…‹"]
    â†“
[å•ä½æ ‡å‡†åŒ–] â†’ ["ä¸‰ä¸ƒ15g", "é»„èŠª20g"]
    â†“
[ç»“æ„åŒ–è¾“å‡º] â†’ "ä¸‰ä¸ƒ15gï¼Œé»„èŠª20g"
```

### è‡ªå®šä¹‰çƒ­è¯

ç¼–è¾‘ `asr/hotwords.txt`ï¼Œæ¯è¡Œä¸€ä¸ªè¯ï¼š

```
ä¸‰ä¸ƒ
é»„èŠª
å…šå‚
å½“å½’
å·èŠ
```

é‡æ–°ç”Ÿæˆçƒ­è¯æ–‡ä»¶ï¼š

```bash
python asr/gen_hotwords.py
```

---

## APIæ¥å£

### WebSocket API

#### è¿æ¥

```javascript
const ws = new WebSocket('ws://localhost:8081');

ws.onopen = () => {
  console.log('è¿æ¥æˆåŠŸ');
};
```

#### æ¶ˆæ¯æ ¼å¼

**1. æ–‡æœ¬æ¶ˆæ¯**

```json
{
  "type": "text",
  "content": "æˆ‘æœ€è¿‘å¤´ç–¼ï¼Œæ€ä¹ˆåŠï¼Ÿ",
  "session_id": "session_123"
}
```

**2. éŸ³é¢‘æ•°æ®**

```json
{
  "type": "audio",
  "data": "base64_encoded_pcm_data",
  "format": "pcm",
  "sample_rate": 16000,
  "session_id": "session_123"
}
```

**3. å›¾ç‰‡ä¸Šä¼ **

```json
{
  "type": "image",
  "data": "base64_encoded_image",
  "filename": "report.jpg",
  "session_id": "session_123"
}
```

#### å“åº”æ ¼å¼

**1. ASRè¯†åˆ«ç»“æœ**

```json
{
  "type": "asr_result",
  "text": "ä¸‰ä¸ƒ15gï¼Œé»„èŠª20g",
  "is_final": true,
  "timestamp": "2026-02-26T10:30:00Z"
}
```

**2. LLMå›å¤**

```json
{
  "type": "llm_response",
  "content": "æ ¹æ®æ‚¨çš„ç—‡çŠ¶ï¼Œå»ºè®®...",
  "session_id": "session_123"
}
```

**3. TTSéŸ³é¢‘**

```json
{
  "type": "tts_audio",
  "audio_data": "base64_encoded_audio",
  "format": "mp3"
}
```

### REST APIï¼ˆè§„åˆ’ä¸­ï¼‰

```bash
# è·å–ä¼šè¯å†å²
GET /api/sessions/{session_id}/history

# ä¸Šä¼ æŠ¥å‘Š
POST /api/reports/upload

# ç”Ÿæˆç—…å†
POST /api/emr/generate
```

---

## é…ç½®æŒ‡å—

### ASRé…ç½®

#### 1. ä¿®æ”¹çƒ­è¯åº“

ç¼–è¾‘ `asr/hotwords.txt`ï¼Œæ·»åŠ è‡ªå®šä¹‰è¯æ±‡ã€‚

#### 2. è°ƒæ•´çº é”™è§„åˆ™

ç¼–è¾‘ `asr/utils/asr_postprocessor.py`ï¼š

```python
# æ·»åŠ æ··æ·†è¯çº é”™
CONFUSION_MAP = {
    "æ–­ä¿¡æ—¶": "é”»ä¿¡çŸ³",
    "æ–­ä¿¡çŸ³": "é”»ä¿¡çŸ³",
    "æ—¶åˆ»": "10å…‹",
    # æ·»åŠ ä½ çš„è§„åˆ™
    "ä½ çš„é”™è¯¯": "æ­£ç¡®è¯æ±‡",
}
```

#### 3. è°ƒæ•´åŒ¹é…é˜ˆå€¼

```python
# æ‹¼éŸ³ç›¸ä¼¼åº¦é˜ˆå€¼ï¼ˆé»˜è®¤85ï¼‰
if score >= 85:  # é™ä½é˜ˆå€¼ä¼šå¢åŠ å¬å›ï¼Œä½†å¯èƒ½è¯¯åŒ¹é…
    best_herb = herb
```

### LLMé…ç½®

#### åˆ‡æ¢æ¨¡å‹

ç¼–è¾‘ `config/config.yaml`ï¼š

```yaml
default:
  # é€šä¹‰åƒé—®
  DASHSCOPE_API_KEY: sk-xxx
  DASHSCOPE_BASE_URL: https://dashscope.aliyuncs.com/compatible-mode/v1
  
  # DeepSeek
  DEEPSEEK_API_KEY: sk-xxx
  DEEPSEEK_API_URL: https://api.deepseek.com/v1
  
  # OpenAI
  OPENIAI_API_KEY: sk-xxx
  OPENIAI_BASE_URL: https://api.openai.com
```

#### ä½¿ç”¨ç¤ºä¾‹

```python
from client.clientfactory import ClientFactory

# åˆ›å»ºå®¢æˆ·ç«¯
client = ClientFactory.create_client("qwen")  # qwen/deepseek/openai

# è°ƒç”¨
response = client.chat("ä½ å¥½")
print(response)
```

### çŸ¥è¯†å›¾è°±é…ç½®

å®‰è£…Neo4jåï¼Œé…ç½®è¿æ¥ï¼š

```python
# kg/Graph.py
NEO4J_URI = "bolt://localhost:7687"
NEO4J_USER = "neo4j"
NEO4J_PASSWORD = "your_password"
```

---

## å¼€å‘è·¯çº¿

### âœ… å·²å®Œæˆ

- [x] å®æ—¶è¯­éŸ³è¯†åˆ«ï¼ˆFunASR + é˜¿é‡Œäº‘ï¼‰
- [x] ä¸­åŒ»å¤„æ–¹åå¤„ç†ï¼ˆä¸­æ–‡æ•°å­—è½¬æ¢ã€è¯æçº é”™ï¼‰
- [x] WebSocketå®æ—¶é€šä¿¡
- [x] å¤šæ¨¡æ€è¾“å…¥ï¼ˆæ–‡æœ¬ã€è¯­éŸ³ã€å›¾ç‰‡ï¼‰
- [x] åŒ»å­¦æŠ¥å‘Šè§£è¯»
- [x] ä¼šè¯ç®¡ç†
- [x] éŸ³é¢‘æ–‡ä»¶è½ç›˜

### ğŸš§ è¿›è¡Œä¸­

- [ ] å‰ç«¯Reactåº”ç”¨å®Œå–„
- [ ] æ•°å­—äººè§†é¢‘æµä¼˜åŒ–
- [ ] å¤„æ–¹ç»“æ„åŒ–æå–å¢å¼º
- [ ] ç—…å†æ¨¡æ¿ç³»ç»Ÿ

### ğŸ“… è®¡åˆ’ä¸­

**Q2 2026**
- [ ] æ•°å­—äººæ‘„åƒå¤´äººè„¸è¯†åˆ«
- [ ] åŒ»æ‚£è®°å½•ç®¡ç†ç³»ç»Ÿ
- [ ] æ•°å­—äººå½¢è±¡/éŸ³è‰²åˆ‡æ¢
- [ ] å®Œæ•´çš„ç®¡ç†åå°

**Q3 2026**
- [ ] ç§»åŠ¨ç«¯é€‚é…
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] ç—…ç§çŸ¥è¯†åº“æ‰©å……
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%

**Q4 2026**
- [ ] äº‘ç«¯éƒ¨ç½²æ–¹æ¡ˆ
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆæ”¯æŒ1000+å¹¶å‘ï¼‰
- [ ] æ•°æ®åˆ†æçœ‹æ¿
- [ ] APIæ–‡æ¡£å®Œå–„

---

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# æµ‹è¯•ASR
python tests/test_asr.py

# æµ‹è¯•é˜¿é‡Œäº‘SDK
python tests/test_ali_sdk_asr.py

# æµ‹è¯•æŠ¥å‘Šè§£è¯»
python tests/test_report_explaination.py

# æµ‹è¯•RAGæ£€ç´¢
python tests/test_analyze_es.py
```

### æµ‹è¯•ç”¨ä¾‹

```python
# tests/test_asr_postprocessor.py
from asr.utils.asr_postprocessor import postprocess_asr

def test_chinese_number_conversion():
    assert postprocess_asr("ä¸‰ä¸ƒåäº”å…‹") == "ä¸‰ä¸ƒ15g"
    assert postprocess_asr("é»„èŠªäºŒåå…‹") == "é»„èŠª20g"

def test_herb_correction():
    assert postprocess_asr("æ–­ä¿¡çŸ³") == "é”»ä¿¡çŸ³"
```

---

## ğŸ“š æ•°æ®è¯´æ˜

### ä¸­è‰è¯æ•°æ®

**æ–‡ä»¶**ï¼š`data/åŒ»ä¿ä¸­è‰è¯æ•°æ®_å…±11071æ¡.csv`

**å­—æ®µ**ï¼š
- åç§°ï¼šè¯æä¸­æ–‡å
- æ‹¼éŸ³ï¼šè¯ææ‹¼éŸ³
- åŠŸæ•ˆï¼šè¯æåŠŸæ•ˆ
- ç”¨æ³•ç”¨é‡ï¼šæ¨èå‰‚é‡

**ç”¨é€”**ï¼š
- ASRçƒ­è¯åº“
- è¯æåç§°çº é”™
- å‰‚é‡åˆç†æ€§æ£€æŸ¥

### å¤„æ–¹æ•°æ®

**æ–‡ä»¶**ï¼š`data/å´å«å¹³å¤„æ–¹æ•°æ®.xlsx`

**å†…å®¹**ï¼šçœŸå®ä¸­åŒ»å¤„æ–¹æ¡ˆä¾‹ï¼Œç”¨äºè®­ç»ƒå’Œæµ‹è¯•

### è®­ç»ƒæ•°æ®

**HuatuoGPTæ•°æ®é›†**ï¼š`HuatuoGPT-sft-data-v1/`
- åŒ»å­¦é—®ç­”å¯¹
- ç—…å†æ ·æœ¬
- è¯Šæ–­æ¨ç†

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯

| ç±»åˆ« | æŠ€æœ¯ |
|------|------|
| **è¯­è¨€** | Python 3.8+ |
| **å¼‚æ­¥æ¡†æ¶** | asyncio, websockets |
| **ASR** | FunASR, é˜¿é‡Œäº‘NLS SDK |
| **LLM** | OpenAI GPT, é€šä¹‰åƒé—®, DeepSeek |
| **TTS** | Edge-TTS |
| **å‘é‡æ£€ç´¢** | FAISS |
| **çŸ¥è¯†å›¾è°±** | Neo4j, py2neo |
| **OCR** | PaddleOCR |
| **éŸ³é¢‘å¤„ç†** | PyAudio, soundfile |

### å‰ç«¯æŠ€æœ¯

| ç±»åˆ« | æŠ€æœ¯ |
|------|------|
| **æ¡†æ¶** | React 18 |
| **çŠ¶æ€ç®¡ç†** | å¾…å®š |
| **UIç»„ä»¶** | å¾…å®š |
| **é€šä¿¡** | WebSocket |
| **éŸ³é¢‘** | Web Audio API |

### AIæ¨¡å‹

| åŠŸèƒ½ | æ¨¡å‹ |
|------|------|
| **è¯­éŸ³è¯†åˆ«** | FunASR (ModelScope) |
| **è¯­è¨€ç†è§£** | GPT-4, Qwen-Max, DeepSeek |
| **å›¾åƒç†è§£** | GPT-4V, Qwen-VL |
| **è¯­éŸ³åˆæˆ** | Edge-TTS |
| **å”‡å½¢åŒæ­¥** | Wav2Lip |
| **å‘é‡åµŒå…¥** | BGE, CLIP |

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æäº¤Issueæˆ–æ”¹è¿›æ–‡æ¡£ï¼

### è´¡çŒ®æµç¨‹

1. Forkæœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤Pull Request

### ä»£ç è§„èŒƒ

- éµå¾ªPEP 8
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£å­—ç¬¦ä¸²
- ç¼–å†™å•å…ƒæµ‹è¯•
- æäº¤å‰è¿è¡Œ `black` å’Œ `flake8`

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## âš ï¸ å…è´£å£°æ˜

**æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œä¸å¾—ç”¨äºå®é™…åŒ»ç–—è¯Šæ–­ã€‚**

- âŒ æœ¬ç³»ç»Ÿä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç”Ÿçš„è¯Šæ–­å’Œæ²»ç–—
- âŒ ä»»ä½•åŒ»ç–—å†³ç­–è¯·å’¨è¯¢æœ‰èµ„è´¨çš„åŒ»ç–—æœºæ„å’ŒåŒ»ç”Ÿ
- âŒ ä½¿ç”¨æœ¬ç³»ç»Ÿäº§ç”Ÿçš„ä»»ä½•åæœç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…

---

## ğŸ“§ è”ç³»æˆ‘ä»¬

- **Issues**ï¼š[GitHub Issues](https://github.com/your-repo/ai_doctor/issues)
- **è®¨è®º**ï¼š[GitHub Discussions](https://github.com/your-repo/ai_doctor/discussions)
- **é‚®ç®±**ï¼šyour-email@example.com

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ Starï¼**

Made with â¤ï¸ by AI Doctor Team

</div>
